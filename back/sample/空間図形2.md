ご提示いただいた新潟県の公立高校入試の過去問（空間図形、最終大問）の傾向に基づき、類似した構成を持つ新たな空間図形の問題を作成し、指定されたステップで解答・解説を作成します。

過去問では、直方体や正四角錐を基にした長さ、面積、体積（切り取り、相似）が頻出しているため、今回は**直方体**を用い、辺上の特殊な比率の点から作られる切り口の**長さ**、**面積**、そして特定の**三角錐の体積**を求める構成としました。

---

### 1. 問題文（小問同士のつながりや，文量を意識）

底面が正方形 ABCD (1辺 6 cm)、高さ $AE=9$ cm の **直方体 ABCD-EFGH** がある。辺 $AE$ 上に $AP=6$ cm となる点 P、辺 $BF$ 上に $BQ=3$ cm となる点 Q、辺 $CG$ 上に $CR=6$ cm となる点 R、辺 $DH$ 上に $DS=3$ cm となる点 S をそれぞれとる。このとき、次の(1)〜(3)の問いに答えなさい。

(1) 線分 **PQ の長さ**を求めなさい。
(2) 4点 P, Q, R, S を頂点とする **四角形 PQRS の面積**を求めなさい。
(3) **三角錐 D-SCQ の体積**を求めなさい。

---

### 2. 問題文から，図形描画のPythonコード

直方体の稜線、特殊な点 P, Q, R, S の位置、および切り口となる四角形 PQRS を補助線（色付き線）として描画します。

```python
# 空間図形描画のための擬似コード
# H を原点(0, 0, 0)とし、HGをx軸、HDをy軸、HEをz軸とする座標系を想定。

import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d.art3d import Poly3DCollection
import numpy as np

# 設定値
L = 6 # 辺の長さ AB=AD=6
H_vert = 9 # 高さ AE=9
P_z = 3  # Pのz座標 (AP=6 より 9-6=3)
Q_z = 6  # Qのz座標 (BQ=3 より 9-3=6)
R_z = 3  # Rのz座標 (CR=6 より 9-6=3)
S_z = 6  # Sのz座標 (DS=3 より 9-3=6)

# 頂点座標
vertices = {
    'H': (0, 0, 0), 'G': (L, 0, 0), 'F': (L, L, 0), 'E': (0, L, 0),
    'D': (0, 0, H_vert), 'C': (L, 0, H_vert), 'B': (L, L, H_vert), 'A': (0, L, H_vert)
}

# 特殊な点 P, Q, R, S
P = (0, L, P_z) 
Q = (L, L, Q_z)
R = (L, 0, R_z)
S = (0, 0, S_z)

# Pythonコード（描画命令を簡略化）
print("""
# 3D描画ライブラリを使用し、直方体を描画。
# 辺の長さ 6, 6, 高さ 9
# P(0, 6, 3), Q(6, 6, 6), R(6, 0, 3), S(0, 0, 6) をプロット。

# 補助線として四角形 PQRS を描画（(2)の切り口）
# ax.plot([P, Q, R, S, P], [P, Q, R, S, P], [P, Q, R, S, P], color='blue', linewidth=1.5)

# 補助線として三角錐 D-SCQ の稜線 DQ, DC, DS, SQ, SC を描画（(3)の立体）
# DC, DS は直方体の辺の一部。DQ, SQ, SC を破線などで強調する。
""")
# 描画の意識: 直方体の基本線に加え、特に切り口 PQRS の四辺を補助線として描画する。
```

---

### 3. 問題文と図形から，解答手順（数値計算は行わず，手順を明確にする）

###### (1) 線分 PQ の長さ
1. $P$ が辺 $AE$ 上、 $Q$ が辺 $BF$ 上の点であり、 $AE // BF$ であることを確認する。
2. $PQ$ を斜辺とする直角三角形を考える。この直角三角形の直角を挟む辺は、直方体の辺 $AB$ の長さ ($6$ cm) と、点 $P$ と $Q$ の高さ方向の差 ($|AP - BQ| = |6 - 3| = 3$ cm) である。
3. 三平方の定理 $PQ^2 = (\text{横方向の差})^2 + (\text{高さ方向の差})^2$ を用いて $PQ$ の長さを求める。

###### (2) 四角形 PQRS の面積
1. 四角形 PQRS の四辺の長さ $PQ, QR, RS, SP$ をそれぞれ求める。(1)と同様に三平方の定理を用いて求める。
2. 四辺がすべて等しいことを確認する ($PQ=QR=RS=SP=3\sqrt{5}$ cm)。
3. 対角線 $PR$ と $QS$ の長さをそれぞれ三平方の定理を用いて求める。
4. $PR$ と $QS$ の長さが等しいことを確認し、四角形 PQRS が**正方形**であることを特定する。
5. 正方形の面積を求める公式 $S = \frac{1}{2} \times (\text{対角線}) \times (\text{対角線})$ を用いて面積を計算する。

###### (3) 三角錐 D-SCQ の体積
1. 三角錐 D-SCQ の体積 $V$ を求めるために、**底面を $\triangle DSC$** とし、**高さを点 $Q$ から底面 $\triangle DSC$ が含まれる平面（面 $DHGC$）に下ろした垂線の長さ $h_Q$** とする。
2. $\triangle DSC$ が $\angle SDC = 90^\circ$ の直角三角形であることを確認する（辺 $DH$ と $DC$ は直交し、 $S$ は $DH$ 上にあるため）。
3. 底面 $\triangle DSC$ の面積 $S_{\triangle DSC} = \frac{1}{2} \times DS \times DC$ を求める。
4. 高さ $h_Q$ は、点 $Q$ から面 $DHGC$ までの距離であり、これは直方体の奥行き $AD$ の長さ ($6$ cm) に等しいことを確認する。
5. 体積の公式 $V = \frac{1}{3} \times S_{\triangle DSC} \times h_Q$ を用いて体積を計算する。

---

### 4. 解答手順から，数値計算を行うPythonプログラム

ルート $(\sqrt{})$ は `math.sqrt()` を使用し、簡潔な形式で表示できるようにします。

```python
import math

# 寸法設定
AB = 6  # DC = 6
AD = 6  # 高さ h_Q = 6
AE = 9
DS = 3  # (3)の底面の辺
BQ = 3
AP = 6

# (1) 線分 PQ の長さ
# 横方向の差 = 6, 高さ方向の差 = |AP - BQ| = |6 - 3| = 3
delta_h_1 = 6
delta_z_1 = 3
length_PQ_sq = delta_h_1**2 + delta_z_1**2
length_PQ = math.sqrt(length_PQ_sq)

# (2) 四角形 PQRS の面積 (正方形)
# 対角線 PR の長さ (Δx=6, Δy=6, Δz=0)
length_PR_sq = 6**2 + 6**2 + 0**2
length_PR = math.sqrt(length_PR_sq) # 6 * sqrt(2)

# 対角線 QS の長さ (Δx=-6, Δy=-6, Δz=0)
length_QS = length_PR # 6 * sqrt(2)

# 面積 S = 1/2 * PR * QS
area_PQRS = 0.5 * length_PR * length_QS

# (3) 三角錐 D-SCQ の体積
# 底面 S_DSC = 1/2 * DS * DC
length_DC = AB
length_DS = 3
area_DSC = 0.5 * length_DC * length_DS # 0.5 * 6 * 3 = 9

# 高さ h_Q = AD = 6 (Q から面 DHGC までの距離)
height_Q = AD

# 体積 V = 1/3 * S_DSC * h_Q
volume_DSCQ = (1/3) * area_DSC * height_Q

# 結果の表示 (ルート形式で出力)
print(f"(1) {length_PQ_sq}の平方根 = {length_PQ:.10f} (3√5)")
print(f"(2) 面積 = {area_PQRS}")
print(f"(3) 体積 = {volume_DSCQ}")
```

---

### 5. 解答手順と数値計算の結果から，完全な解答・解説

###### 解答
(1) **$3\sqrt{5}$ (cm)**
(2) **36 ($\text{cm}^2$)**
(3) **18 ($\text{cm}^3$)**

###### 解説
**(1) 線分 PQ の長さ**
$PQ$ を斜辺とする直角三角形を考えると、直角を挟む辺の長さは、直方体の底辺の長さ $AB=6$ cm と、高さ方向の差 $|AP - BQ| = |6 - 3| = 3$ cm です。
三平方の定理より、
$PQ^2 = 6^2 + 3^2 = 36 + 9 = 45$。
よって、 $PQ = \sqrt{45} = 3\sqrt{5}$ (cm) となります。

**(2) 四角形 PQRS の面積**
$QR, RS, SP$ の長さも (1) と同様に $3\sqrt{5}$ cm となるため、四角形 PQRS はひし形です。
次に、対角線 $PR$ と $QS$ の長さを求めます。
対角線 $PR$ は、底面 $ABCD$ の対角線 $AC$ と同じ平面に平行であり、高さの差がないため ($AP=CR=6$ cm)、横方向の差 $AB=6$ cm、奥行き方向の差 $AD=6$ cm を用いて、
$PR^2 = 6^2 + 6^2 + 0^2 = 72$。 $PR = 6\sqrt{2}$ (cm)。
同様に、対角線 $QS$ も、横方向の差 $CD=6$ cm、奥行き方向の差 $DH=6$ cm を用い、高さの差がないため ($DS=BQ=3$ cm)、
$QS^2 = 6^2 + 6^2 + 0^2 = 72$。 $QS = 6\sqrt{2}$ (cm)。
$PR=QS$ なので、四角形 PQRS は正方形です。
面積 $S$ は、対角線を用いて求められ、
$S = \frac{1}{2} \times PR \times QS = \frac{1}{2} \times 6\sqrt{2} \times 6\sqrt{2} = \frac{1}{2} \times 72 = 36$ ($\text{cm}^2$)。

**(3) 三角錐 D-SCQ の体積**
三角錐 D-SCQ の体積を求めるために、底面を $\triangle DSC$ とし、高さを点 $Q$ から底面 $\triangle DSC$ を含む平面 $DHGC$ に下ろした垂線の長さ $h_Q$ とします。
1.  **底面 $\triangle DSC$ の面積:**
    $D$ は直方体の頂点であり、 $S$ は辺 $DH$ 上の点、 $C$ は頂点です。辺 $DC$ と辺 $DH$ は直交するため、線分 $DC$ と $DS$ も直交します（ $\angle SDC = 90^\circ$ ）。
    $DC=6$ cm, $DS=3$ cm なので、
    $S_{\triangle DSC} = \frac{1}{2} \times DC \times DS = \frac{1}{2} \times 6 \times 3 = 9$ ($\text{cm}^2$)。
2.  **高さ $h_Q$:**
    点 $Q$ は辺 $BF$ 上にあり、面 $DHGC$ と面 $ABFE$ は辺 $AD=6$ cm の距離だけ離れています。点 $Q$ から面 $DHGC$ へ下ろした垂線の長さ $h_Q$ は、 $AD$ の長さに等しく、 $h_Q = 6$ cm です。
3.  **体積 $V$ の計算:**
    $V = \frac{1}{3} \times S_{\triangle DSC} \times h_Q = \frac{1}{3} \times 9 \times 6 = 18$ ($\text{cm}^3$)。