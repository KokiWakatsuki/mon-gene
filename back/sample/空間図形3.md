ご提示いただいた新潟県の公立高校入試の過去問（空間図形、最終大問）の傾向に基づき、類似した構成を持つ新たな空間図形の問題を作成し、指定されたステップで解答・解説を作成します。

過去問では、直方体や正四角錐を題材とした長さ、面積、体積を求める問題が頻出しており、特に内部の点の比率を利用した問題も多く見られます。ここでは、正四角錐を題材とし、長さ、相似を用いた長さ、そして特定の断面の面積を求める問題を構成しました。

---

### 類似問題の作成

#### 1. 問題文（小問同士のつながりや，文量を意識）
底面の一辺が **$8$ cm** の正方形 ABCD であり、すべての側稜の長さが **$10$ cm** の正四角錐 O-ABCD がある。辺 OA 上に $OP=6$ cm となる点 P をとり、辺 OC 上に $OQ=6$ cm となる点 Q をとる。このとき、次の(1)〜(3)の問いに答えなさい。

(1) 正四角錐 O-ABCD の高さを求めなさい。
(2) 線分 PQ の長さを求めなさい。
(3) $\triangle PBQ$ の面積を求めなさい。

---

#### 2. 問題文から，図形描画のPythonコード
正四角錐 O-ABCD の稜線と、点 P, Q および $\triangle PBQ$ を補助線として描画します。

```python
# Pythonでの描画コードの例 (matplotlibやvpythonを使用する場合を想定)
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
import numpy as np
import math

# 設定値
a = 8 # 底面の一辺
L = 10 # 側稜の長さ

# 座標の定義 (底面の中心を原点(0, 0, 0)とする)
h = math.sqrt(L**2 - (math.sqrt(2 * a**2) / 2)**2) # 高さ h = 2*sqrt(17)

A = (a/2, -a/2, 0) # (4, -4, 0)
B = (a/2, a/2, 0)  # (4, 4, 0)
C = (-a/2, a/2, 0) # (-4, 4, 0)
D = (-a/2, -a/2, 0) # (-4, -4, 0)
O = (0, 0, h)

# P, Q の座標 (OからA, Cへ 3:2 の位置。OP=OQ=6)
ratio = 6.0 / L # 3/5
P = tuple((1 - ratio) * np.array(O) + ratio * np.array(A))
Q = tuple((1 - ratio) * np.array(O) + ratio * np.array(C))

# 描画設定（3D図形として表現）
def draw_pyramid_and_section():
    fig = plt.figure()
    ax = fig.add_subplot(111, projection='3d')

    # 稜線 (通常線)
    points = [A, B, C, D, A, O, B, O, C, O, D]
    X, Y, Z = zip(*points)
    ax.plot(X, Y, Z, color='gray')

    # 底面対角線 AC (破線)
    diag_ac = [A, C]
    X_ac, Y_ac, Z_ac = zip(*diag_ac)
    ax.plot(X_ac, Y_ac, Z_ac, color='gray', linestyle='--')

    # 断面三角形 PBQ (補助線/強調線)
    section_points = [P, B, Q, P]
    X_sec, Y_sec, Z_sec = zip(*section_points)
    ax.plot(X_sec, Y_sec, Z_sec, color='blue', linewidth=2)

    # 点のプロット
    for pt, label in zip([O, A, B, C, D, P, Q], ['O', 'A', 'B', 'C', 'D', 'P', 'Q']):
        ax.scatter(*pt, color='red')
        ax.text(pt, pt, pt, label, fontsize=10)

    # 軸設定 (見やすさのため)
    max_range = np.array([X, Y, Z]).ptp().max() / 2.0
    mid_x = (np.array(X).max() + np.array(X).min()) / 2
    mid_y = (np.array(Y).max() + np.array(Y).min()) / 2
    mid_z = (np.array(Z).max() + np.array(Z).min()) / 2
    ax.set_xlim(mid_x - max_range, mid_x + max_range)
    ax.set_ylim(mid_y - max_range, mid_y + max_range)
    ax.set_zlim(mid_z - max_range, mid_z + max_range)
    ax.set_title("正四角錐 O-ABCD と断面 PBQ")
    ax.set_xlabel("X")
    ax.set_ylabel("Y")
    # plt.show() # 実行環境によっては表示が必要
    return "Pythonコード生成完了"

# draw_pyramid_and_section()
```

---

#### 3. 問題文と図形から，解答手順（数値計算は行わず，手順を明確にする）

###### (1) 正四角錐 O-ABCD の高さ
1.  底面の正方形 ABCD の対角線 AC の長さを、三平方の定理を用いて求める。
2.  底面の中心を M とし、 $AM = \frac{1}{2} AC$ を求める。
3.  直角三角形 OMA に対して三平方の定理 $OM^2 = OA^2 - AM^2$ を適用し、高さ $OM$ を求める。

###### (2) 線分 PQ の長さ
1.  点 P は辺 OA 上、点 Q は辺 OC 上の点であり、 $OP:OA = OQ:OC = 6:10 = 3:5$ であることを確認する。
2.  P, Q はそれぞれ辺 OA, OC を $3:5$ の比に分けるため、 $\triangle OPQ$ は $\triangle OAC$ と相似であり、相似比は $3:5$ である。
3.  $\triangle OAC$ の底辺 $AC$ の長さと相似比を用いて、 $PQ$ の長さを求める。

###### (3) $\triangle PBQ$ の面積
1.  $P$ と $Q$ は正四角錐の対角線上の点にあり、$OA=OC$、$AB=CB$ であることから、 $BP$ と $BQ$ の長さが等しいことを確認する。 $\triangle PBQ$ は二等辺三角形である。
2.  $\triangle OAB$ に着目し、 $BP$ の長さを求める。（例えば、 $\triangle OAB$ に余弦定理を適用し $\angle AOB$ を求めた後、 $\triangle POB$ に余弦定理を適用する、または3次元座標を利用する）。
3.  (2) で求めた $PQ$ の長さと $BP$ の長さを用いて、二等辺三角形 $\triangle PBQ$ の面積を求める。
4.  $PQ$ の中点を K とし、 $BK$ の長さ（ $\triangle PBQ$ の高さ）を $BK^2 = BP^2 - PK^2$ を用いて求める。
5.  $\triangle PBQ$ の面積 $S = \frac{1}{2} \times PQ \times BK$ を計算する。

---

#### 4. 解答手順から，数値計算を行うPythonプログラム

```python
import math

# 定義された値
a = 8  # 底面の一辺 AB
L = 10 # 側稜の長さ OA, OB, OC, OD

# (1) 正四角錐 O-ABCD の高さ
# 1. 対角線 AC の長さ
AC = a * math.sqrt(2) # 8√2
# 2. AM の長さ (Mは中心)
AM = AC / 2          # 4√2
# 3. 高さ h = OM の計算
h_sq = L**2 - AM**2
h = math.sqrt(h_sq)

# (2) 線分 PQ の長さ
# 相似比 OP:OA = 6:10 = 3:5
ratio = 6 / 10
PQ = AC * ratio

# (3) ΔPBQ の面積
# 1. BP の長さの計算 (座標系を用いて計算)
# 底面中心を原点(0, 0, 0)とする。B = (4, 4, 0)。O = (0, 0, h)。A = (4, -4, 0)
# PはOAを3:2に内分する点 (P = 2A/5 + 3O/5)
# P_x = 2 * (a/2) / 5 = 4/5 = 0.8  (待て、座標設定を(4, -4)としたものが正確)
# A = (4, -4, 0), B = (4, 4, 0), C = (-4, 4, 0), D = (-4, -4, 0). O = (0, 0, h)

# P = 2/5 * O + 3/5 * A  -> P = (3/5 * 4, 3/5 * -4, 2/5 * h)
P_coords = (3 * (a/2) / 5, 3 * (-a/2) / 5, 2 * h / 5) # (2.4, -2.4, 0.4 * h)
B_coords = (a/2, a/2, 0) # (4, 4, 0)

# BP^2 = (B_x - P_x)^2 + (B_y - P_y)^2 + (B_z - P_z)^2
BP_sq = ((a/2) - P_coords)**2 + ((a/2) - P_coords)**2 + (0 - P_coords)**2
BP_sq = (4 - 2.4)**2 + (4 - (-2.4))**2 + (P_coords)**2
BP_sq = (1.6)**2 + (6.4)**2 + (0.4 * h)**2
BP_sq = 2.56 + 40.96 + (0.16 * h_sq) # h_sq = 68
BP_sq = 43.52 + (0.16 * 68)
BP_sq = 43.52 + 10.88
BP = math.sqrt(BP_sq) # BP = sqrt(54.4)

# 2. ΔPBQ の高さ BK (KはPQの中点)
PK = PQ / 2
BK_sq = BP_sq - PK**2 # BP^2 - (PQ/2)^2
BK_sq = 54.4 - (PQ / 2)**2

# PQ = 8 * sqrt(2) * 3/5 = 24 * sqrt(2) / 5
# (PQ/2)^2 = (12 * sqrt(2) / 5)^2 = 144 * 2 / 25 = 288 / 25 = 11.52
BK_sq = 54.4 - 11.52
BK = math.sqrt(BK_sq)

# 3. 面積 S
S = 0.5 * PQ * BK

# ルート表示のための簡略化処理
def simplify_sqrt(n):
    if n == 0: return 0
    i = 2
    factor = 1
    while i * i <= n:
        if n % (i * i) == 0:
            factor *= i
            n //= (i * i)
        else:
            i += 1
    if factor == 1:
        return f"\\sqrt{{{int(n)}}}"
    elif n == 1:
        return f"{factor}"
    else:
        return f"{factor}\\sqrt{{{int(n)}}}"

# 結果の整理
h_simplified = simplify_sqrt(68) # 2√17
PQ_num = (24 * math.sqrt(2)) / 5
PQ_simplified = f"\\frac{{24\\sqrt{{2}}}}{{5}}"

BK_num = math.sqrt(42.88)
# 42.88 = 4288/100 = 1072/25 = (16 * 67) / 25
BK_simplified = f"\\frac{{4\\sqrt{{67}}}}{{5}}"

S_simplified_num = S
# S = 1/2 * (24√2/5) * (4√67/5) = 48√134 / 25
S_simplified = f"\\frac{{48\\sqrt{{134}}}}{{25}}"


print(f"(1) 高さ h^2 = L^2 - (A*sqrt(2)/2)^2 を使用。 h = {h_simplified} (cm)")
print(f"(2) 線分 PQ: 相似比 3:5 を使用。 PQ = AC * 3/5。 PQ = {PQ_simplified} (cm)")
print(f"(3) 面積 S: S = 1/2 * PQ * BK を使用。BK^2 = BP^2 - (PQ/2)^2。 BP^2 = 54.4。 BK = {BK_simplified} (cm)。 S = {S_simplified} (cm^2)")
```

---

#### 5. 解答手順と数値計算の結果から，完全な解答・解説

###### 解答
(1) **$2\sqrt{17}$ (cm)**
(2) **$\frac{24\sqrt{2}}{5}$ (cm)**
(3) **$\frac{48\sqrt{134}}{25}$ ($\text{cm}^2$)**

###### 解説

**(1) 正四角錐 O-ABCD の高さ**
底面 ABCD の中心を M とすると、高さは OM の長さです。まず、底面の対角線 AC の長さを求めます。
$AC = \sqrt{AB^2 + BC^2} = \sqrt{8^2 + 8^2} = \sqrt{64 + 64} = \sqrt{128} = 8\sqrt{2}$ (cm)。
$M$ は $AC$ の中点なので、$AM = \frac{1}{2} AC = 4\sqrt{2}$ (cm)。
直角三角形 $\triangle OMA$ において、三平方の定理より $OM^2 = OA^2 - AM^2$ です。
$OM^2 = 10^2 - (4\sqrt{2})^2 = 100 - 32 = 68$。
よって、高さ $OM = \sqrt{68} = 2\sqrt{17}$ (cm) となります。

**(2) 線分 PQ の長さ**
点 P は辺 OA 上に $OP=6$ cm となるようにあり、点 Q は辺 OC 上に $OQ=6$ cm となるようにあります [問題文]。
$OP:OA = 6:10 = 3:5$、 $OQ:OC = 6:10 = 3:5$ です。
$\triangle OPQ$ と $\triangle OAC$ は、2組の辺の比とその間の角 $\angle AOC$ が等しいので相似であり、相似比は $3:5$ です。
したがって、 $PQ = AC \times \frac{3}{5}$ となります。
$PQ = 8\sqrt{2} \times \frac{3}{5} = \frac{24\sqrt{2}}{5}$ (cm)。

**(3) $\triangle PBQ$ の面積**
$BP$ の長さを求めるために、まず点 $P$ の底面からの高さを利用します。
$\triangle OAB$ と $\triangle OCB$ は合同な二等辺三角形であり、 $P$ と $Q$ はそれぞれ $OA$ と $OC$ を同じ比率で分けるため、 $BP = BQ$ であり、 $\triangle PBQ$ は二等辺三角形です。
$BP^2$ を求めるには、点 $P$ の底面からの投影 $P'$ を用いるか、3次元距離の公式を用います。
(1)より、正四角錐の高さ $h = 2\sqrt{17}$ cm。
底面中心を M(0, 0, 0) とすると、B(4, 4, 0)、O(0, 0, $2\sqrt{17}$)。
点 P の座標は、 $P = \frac{3}{5}A + \frac{2}{5}O$ を利用し、 $P_x = \frac{3}{5} \times 4 = 2.4$、 $P_y = \frac{3}{5} \times (-4) = -2.4$、$P_z = \frac{2}{5} \times 2\sqrt{17} = \frac{4\sqrt{17}}{5}$。
$BP^2$ を計算すると、
$BP^2 = (4 - 2.4)^2 + (4 - (-2.4))^2 + (0 - \frac{4\sqrt{17}}{5})^2$
$BP^2 = (1.6)^2 + (6.4)^2 + \frac{16 \times 17}{25} = 2.56 + 40.96 + 10.88 = 54.4$。
$BP = \sqrt{54.4} = \sqrt{\frac{272}{5}} = \frac{4\sqrt{85}}{5}$ (cm)。

次に、 $\triangle PBQ$ の面積を求めます。 $PQ$ の中点を K とすると、 $BK$ が高さです。
$PK = \frac{1}{2} PQ = \frac{1}{2} \times \frac{24\sqrt{2}}{5} = \frac{12\sqrt{2}}{5}$ (cm)。
直角三角形 $\triangle PKB$ において、三平方の定理より、
$BK^2 = BP^2 - PK^2 = 54.4 - (\frac{12\sqrt{2}}{5})^2$
$BK^2 = 54.4 - \frac{288}{25} = 54.4 - 11.52 = 42.88$
$BK = \sqrt{42.88} = \sqrt{\frac{1072}{25}} = \frac{\sqrt{16 \times 67}}{5} = \frac{4\sqrt{67}}{5}$ (cm)。

面積 $S$ は、
$S = \frac{1}{2} \times PQ \times BK = \frac{1}{2} \times \frac{24\sqrt{2}}{5} \times \frac{4\sqrt{67}}{5}$
$S = \frac{48\sqrt{134}}{25}$ ($\text{cm}^2$)。